---
import BaseLayout from "../layouts/BaseLayout.astro";
import BlogCard from "../components/Cards/BlogCard.astro";
import ProjectCard from "../components/Cards/ProjectCard.astro";
import MusingsCard from "../components/Cards/MusingsCard.astro";
import Hero from "../components/Hero/Hero.astro";
import DividerTitle from "../components/Layout/DividerTitle.astro";
import ContentGrid from "../components/Layout/ContentGrid.astro";

import { getPublishedEntries } from "../utils";

// Fetch Pinned Posts
let blogs = await getPublishedEntries("blog", true);
let projects = await getPublishedEntries("projects", true);
let musings = await getPublishedEntries("musings", true);

// Map Posts to Components and limit the entries
const PROJECT_LIMIT = 2; // Set the limit for projects
const BLOG_LIMIT = 2; // Set the limit for blogs
const MUSINGS_LIMIT = 2; // Set the limit for musings

const project_elems = [
  ...projects.slice(0, PROJECT_LIMIT).map((entry) => ({
    component: ProjectCard,
    props: { entry: entry },
  })),
];

const blog_elems = [
  ...blogs.slice(0, BLOG_LIMIT).map((entry) => ({
    component: BlogCard,
    props: { entry: entry },
  })),
];

const musings_elems = [
  ...musings.slice(0, MUSINGS_LIMIT).map((entry) => ({
    component: MusingsCard,
    props: { entry: entry },
  })),
];
---

<BaseLayout title="Iterating, Always">
  <Hero />
  <!-- <DividerTitle text="Projects" slug="/projects" /> -->
  <ContentGrid elements={project_elems} />
  <!-- <DividerTitle text="Blog" slug="/blog" /> -->
  <ContentGrid elements={blog_elems} />
  <!-- <DividerTitle text="Musings" slug="/musings" /> -->
  <ContentGrid elements={musings_elems} />
</BaseLayout>
