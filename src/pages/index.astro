---
import BaseLayout from "../layouts/BaseLayout.astro";
import BlogCard from "../components/Cards/BlogCard.astro";
import ProjectCard from "../components/Cards/ProjectCard.astro";
import MusingsCard from "../components/Cards/MusingsCard.astro";
import Hero from "../components/Hero/Hero.astro";
import ContentGrid from "../components/Layout/ContentGrid.astro";
import heroImage from "../content/supplements/images/PatrickGhibliCircle.png";

const meta = {
  description: "Personal website of Patrick Youssef. Iterating, Always. Numerical computation, ML, musings, projects, and more.",
  image: heroImage.src,
  url: "https://patrickyoussef.com",
};

import { getPublishedEntries, sortEntries } from "../utils";

// Fetch Pinned Posts
let projects = await getPublishedEntries("projects", true);
let blogs = await getPublishedEntries("blog", true);
let musings = await getPublishedEntries("musings", true);

// Map Posts to Components and limit the entries
const PROJECT_LIMIT = 3; // Set the limit for projects
const BLOG_LIMIT = 2; // Set the limit for blogs
const MUSINGS_LIMIT = 2; // Set the limit for musings

// Combine Posts and Sort by Date
let entries = sortEntries([...projects.slice(0, PROJECT_LIMIT), ...blogs.slice(0, BLOG_LIMIT), ...musings.slice(0, MUSINGS_LIMIT)]);

// Mapping Collection to Component
const component_map = {
  projects: ProjectCard,
  blog: BlogCard,
  musings: MusingsCard,
};

const elements = [
  ...entries.map((entry) => ({
    component: component_map[entry.collection],
    props: { entry: entry },
  })),
];
---

<BaseLayout title="Iterating, Always" meta={meta}>
  <Hero />
  <ContentGrid elements={elements} startIdx={2} />
</BaseLayout>
